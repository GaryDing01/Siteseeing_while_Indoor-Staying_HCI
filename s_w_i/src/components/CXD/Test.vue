<template>
  <div class="share">
    <Header></Header>
    <div class="content">
      <div class="note-container">
        <div class="note-wrapper">
          <div class="note-column">
            <div class="note">
              <div class="note-info">
                <div class="page">
                  <div class="box">
                    <div class="slideWrapper">
                      <a href="xxx" target="_blank"
                        ><img class="slide" src="xxx.jpg "
                      /></a>
                    </div>
                    <div class="slideWrapper">
                      <a href="xxx" target="_blank"
                        ><img class="slide" src="xxx.jpg "
                      /></a>
                    </div>
                  </div>
                </div>
                <!-- <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div> -->
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
          </div>
          <div class="note-column">
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
          </div>
          <div class="note-column">
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
          </div>
          <div class="note-column">
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
          </div>
          <div class="note-column">
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
            <div class="note">
              <div class="note-info">
                <div class="note-image">
                  <div class="overflow-block">
                    <div class="overflow-container loaded">
                      <img
                        class="lazyload loaded img"
                        src="../../assets/test.png"
                      />
                    </div>
                  </div>
                </div>
                <a class="title">上海佘山，出门野餐时记得带水果呀</a>
              </div>
              <div class="info">
                <div class="user">
                  <div class="user-image-wrapper">
                    <img class="img" src="../../assets/user1.jpg" />
                  </div>
                  <span class="user-name">shadon</span>
                </div>
                <div class="like">
                  <i class="heart"></i>
                  <span class="like-num">221</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import Header from "@/components/CXD/header";
export default {
  components: {
    Header
  },
  data() {
    return {
      index: 1,
      moveWith,
      dotItems,
      animate,
      currentX,
      moveX,
      currentOffset,
      minMoveOffset,
      imgLen,
      boxDom,
      isAutoPlay,
      isKeyDown: false,
      isDragingImg: false,
      DEFAULT_DURATION: "300ms",
      ANIMATION_INTERVAL: 3000
    };
  },
  mounted: function() {
    setTimeout(() => {
      this.init();
    }, 1000);
  },
  methods: {
    init() {
      boxDom.addEventListener("mousedown", e => {
        stopAutoPlay();
        this.isKeyDown = true;
        isDragingImg = false;
        currentX = e.clientX;
      });
      boxDom.addEventListener("mousemove", e => {
        if (isKeyDown) {
          moveX = e.clientX - currentX;
          let moveOffset = moveX - currentOffset;
          changeBoxDomStyle(moveOffset);
          isDragingImg = true;
        }
      });
      document.onmouseup = function() {
        isKeyDown = false;
        if (Math.abs(moveX) > minMoveOffset) {
          if (moveX > 0) {
            //移动到前一个图片
            if (index === 1) {
              //移动到真正的图片8
              index = imgLen - 2;
              currentOffset = index * moveWith;
            } else {
              index = index - 1;
              currentOffset = currentOffset - moveWith;
            }
          } else {
            //移动到后一个图片
            currentOffset = currentOffset + moveWith;
            index = index + 1;
            if (index === imgLen - 1) {
              //移动到真正的图片1
              currentOffset = moveWith;
              index = 1;
            }
          }
          changeDotsStyle();
        }
        changeBoxDomStyle(-currentOffset, "300ms");
        autoPlay();
      };
      window.addEventListener(
        "resize",
        () => {
          stopAutoPlay();
          moveWith = document.querySelector(".slide").offsetWidth;
          minMoveOffset = moveWith / 2;
          currentOffset = index * moveWith;
          changeBoxDomStyle(-currentOffset);
          autoPlay();
        },
        false
      );
    },
    stopImgDrag() {
      let slideImgs = document.querySelectorAll("img.slide");
      for (img of slideImgs) {
        img.ondragstart = () => {
          return false;
        };
      }
    },
    linkClickContr() {
      let aNodeList = document.querySelectorAll(".slideWrapper > a");
      for (let i of aNodeList)
        i.addEventListener("click", e => {
          if (isDragingImg) {
            //isDragingImg在mousemove里面设置成了true
            e.preventDefault();
          }
        });
    }
  }
};
</script>

<style scoped>
.share {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: scroll;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
/* content */
.content {
  position: relative;
  margin-top: 100px;
  padding-bottom: 50px;
  border-top: 1px solid #eee;
  background-color: #fff;
}
.content .note-container {
  margin: 30px 0 0;
}
.content .note-wrapper {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: flex-start;
}
.content .note-wrapper .note-column {
  margin: 0 20px 0 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
}
.content .note-wrapper .note-column .note {
  width: 220px;
  margin: 0 0 20px;
  background-color: #fff;
  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 10%);
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  position: relative;
}
.note::after {
  /* 需要显示的内容为空 */
  content: "";
  /* color: #fff; */
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.3) no-repeat center;
  background-size: 30px 30px;
}
.note:hover::after {
  display: block;
}
.note .page {
  /* 让视线范围内只显示一张图片 */
  overflow: hidden;
  /* 用于点的定位 */
  position: relative;
}
.note .page .box {
  display: flex;
  /* 设置flex布局，默认从左到右依次排列。 */
}
.page .box .slideWrapper {
  width: 100%;
  height: 100%;
  flex-shrink: 0;
  /* 不让容器等比例缩小 */
}
.note .note-info {
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
}
.note .note-info .note-image {
  position: relative;
}
.note .note-info .note-image .overflow-block {
  overflow: hidden;
}
.note .note-info .note-image .overflow-container {
  position: relative;
  transition: filter 0.7s ease;
}
.note .note-info .note-image {
  filter: none;
}
.note .note-info .img {
  width: 100%;
}
.note .note-info .title {
  padding: 0;
  margin: 10px 15px;
  color: #000;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
}
.note .info {
  padding: 0 15px 10px;
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
}
.note .info .user {
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
}
.note .info .user .user-image-wrapper {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  position: relative;
  overflow: hidden;
}
.note .info .user .user-image {
  width: 100%;
  height: 100%;
}
.note .info .user .user-name {
  width: 87px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  margin-left: 10px;
  color: #555;
  font-size: 12px;
}

.note .info .like {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
}
.note .info .like .heart {
  width: 18px;
  height: 18px;
  background-image: url("../../assets/heart-gray.png");
  background-repeat: no-repeat;
  background-size: contain;
}
.note .info .like .like-num {
  margin-left: 8px;
  color: #555;
  font-size: 12px;
}
.lazyload {
  transition: opacity 0.7s ease;
}
.lazyload .loaded {
  opacity: 1;
}
</style>
